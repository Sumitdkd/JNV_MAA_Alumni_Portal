{"ast":null,"code":"var _jsxFileName = \"/Users/sumitdhaker/Desktop/Alumni_Portal_JNVChittorgarh/frontend/src/context/SocketContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport io from 'socket.io-client';\nimport useAuth from '../hooks/useAuth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SocketContext = /*#__PURE__*/createContext();\nexport const useSocket = () => {\n  _s();\n  return useContext(SocketContext);\n};\n_s(useSocket, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nconst SOCKET_URL = process.env.REACT_APP_API_URL.replace(\"/api\", \"\");\nexport const SocketProvider = ({\n  children\n}) => {\n  _s2();\n  const [socket, setSocket] = useState(null);\n  const {\n    user\n  } = useAuth();\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user._id) {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.error('No authentication token found for socket connection');\n        return;\n      }\n      const newSocket = io(SOCKET_URL, {\n        transports: ['websocket', 'polling'],\n        reconnection: true,\n        reconnectionAttempts: 5,\n        reconnectionDelay: 1000,\n        auth: {\n          token: token\n        }\n      });\n      newSocket.on('connect', () => {\n        console.log('Socket connected successfully');\n      });\n      newSocket.on('connect_error', error => {\n        console.error('Socket connection error:', error.message);\n        if (error.message.includes('Authentication error')) {\n          // Handle authentication errors\n          console.log('Socket authentication failed, token may be invalid');\n        }\n      });\n      setSocket(newSocket);\n      return () => {\n        newSocket.close();\n      };\n    } else {\n      if (socket) {\n        socket.close();\n        setSocket(null);\n      }\n    }\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(SocketContext.Provider, {\n    value: socket,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 9\n  }, this);\n};\n_s2(SocketProvider, \"rNH/wROXkn15ameLVM1zi1Ia8cQ=\", false, function () {\n  return [useAuth];\n});\n_c = SocketProvider;\nvar _c;\n$RefreshReg$(_c, \"SocketProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","io","useAuth","jsxDEV","_jsxDEV","SocketContext","useSocket","_s","SOCKET_URL","process","env","REACT_APP_API_URL","replace","SocketProvider","children","_s2","socket","setSocket","user","_id","token","localStorage","getItem","console","error","newSocket","transports","reconnection","reconnectionAttempts","reconnectionDelay","auth","on","log","message","includes","close","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/sumitdhaker/Desktop/Alumni_Portal_JNVChittorgarh/frontend/src/context/SocketContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport io from 'socket.io-client';\nimport useAuth from '../hooks/useAuth';\n\nconst SocketContext = createContext();\nexport const useSocket = () => useContext(SocketContext);\nconst SOCKET_URL = process.env.REACT_APP_API_URL.replace(\"/api\", \"\");\n\nexport const SocketProvider = ({ children }) => {\n    const [socket, setSocket] = useState(null);\n    const { user } = useAuth();\n\n    useEffect(() => {\n        if (user?._id) {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('No authentication token found for socket connection');\n                return;\n            }\n\n            const newSocket = io(SOCKET_URL, {\n                transports: ['websocket', 'polling'],\n                reconnection: true,\n                reconnectionAttempts: 5,\n                reconnectionDelay: 1000,\n                auth: {\n                    token: token\n                }\n            });\n\n            newSocket.on('connect', () => {\n                console.log('Socket connected successfully');\n            });\n\n            newSocket.on('connect_error', (error) => {\n                console.error('Socket connection error:', error.message);\n                if (error.message.includes('Authentication error')) {\n                    // Handle authentication errors\n                    console.log('Socket authentication failed, token may be invalid');\n                }\n            });\n\n            setSocket(newSocket);\n\n            return () => {\n                newSocket.close();\n            };\n        } else {\n            if (socket) {\n                socket.close();\n                setSocket(null);\n            }\n        }\n    }, [user]);\n\n    return (\n        <SocketContext.Provider value={socket}>\n            {children}\n        </SocketContext.Provider>\n    );\n};"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC7E,OAAOC,EAAE,MAAM,kBAAkB;AACjC,OAAOC,OAAO,MAAM,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvC,MAAMC,aAAa,gBAAGR,aAAa,CAAC,CAAC;AACrC,OAAO,MAAMS,SAAS,GAAGA,CAAA;EAAAC,EAAA;EAAA,OAAMT,UAAU,CAACO,aAAa,CAAC;AAAA;AAACE,EAAA,CAA5CD,SAAS;AACtB,MAAME,UAAU,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,CAACC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC;AAEpE,OAAO,MAAMC,cAAc,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAC5C,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EAC1C,MAAM;IAAEkB;EAAK,CAAC,GAAGhB,OAAO,CAAC,CAAC;EAE1BH,SAAS,CAAC,MAAM;IACZ,IAAImB,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEC,GAAG,EAAE;MACX,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAI,CAACF,KAAK,EAAE;QACRG,OAAO,CAACC,KAAK,CAAC,qDAAqD,CAAC;QACpE;MACJ;MAEA,MAAMC,SAAS,GAAGxB,EAAE,CAACO,UAAU,EAAE;QAC7BkB,UAAU,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC;QACpCC,YAAY,EAAE,IAAI;QAClBC,oBAAoB,EAAE,CAAC;QACvBC,iBAAiB,EAAE,IAAI;QACvBC,IAAI,EAAE;UACFV,KAAK,EAAEA;QACX;MACJ,CAAC,CAAC;MAEFK,SAAS,CAACM,EAAE,CAAC,SAAS,EAAE,MAAM;QAC1BR,OAAO,CAACS,GAAG,CAAC,+BAA+B,CAAC;MAChD,CAAC,CAAC;MAEFP,SAAS,CAACM,EAAE,CAAC,eAAe,EAAGP,KAAK,IAAK;QACrCD,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAACS,OAAO,CAAC;QACxD,IAAIT,KAAK,CAACS,OAAO,CAACC,QAAQ,CAAC,sBAAsB,CAAC,EAAE;UAChD;UACAX,OAAO,CAACS,GAAG,CAAC,oDAAoD,CAAC;QACrE;MACJ,CAAC,CAAC;MAEFf,SAAS,CAACQ,SAAS,CAAC;MAEpB,OAAO,MAAM;QACTA,SAAS,CAACU,KAAK,CAAC,CAAC;MACrB,CAAC;IACL,CAAC,MAAM;MACH,IAAInB,MAAM,EAAE;QACRA,MAAM,CAACmB,KAAK,CAAC,CAAC;QACdlB,SAAS,CAAC,IAAI,CAAC;MACnB;IACJ;EACJ,CAAC,EAAE,CAACC,IAAI,CAAC,CAAC;EAEV,oBACId,OAAA,CAACC,aAAa,CAAC+B,QAAQ;IAACC,KAAK,EAAErB,MAAO;IAAAF,QAAA,EACjCA;EAAQ;IAAAwB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAEjC,CAAC;AAAC1B,GAAA,CApDWF,cAAc;EAAA,QAENX,OAAO;AAAA;AAAAwC,EAAA,GAFf7B,cAAc;AAAA,IAAA6B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}