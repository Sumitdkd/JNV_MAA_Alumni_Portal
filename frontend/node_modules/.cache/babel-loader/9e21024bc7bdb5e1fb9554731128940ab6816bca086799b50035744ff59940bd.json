{"ast":null,"code":"var _jsxFileName = \"/Users/sumitdhaker/Desktop/JNV MAA/frontend/src/pages/Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport useAuth from \"../hooks/useAuth\";\nimport postService from \"../services/postService\";\nimport userService from \"../services/userService\";\nimport PostCard from \"../components/posts/PostCard\";\nimport PostForm from \"../components/posts/PostForm\";\nimport BirthdayCard from \"../components/home/BirthdayCard\";\nimport Spinner from \"../components/common/Spinner\";\nimport toast from \"react-hot-toast\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Dashboard() {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [posts, setPosts] = useState([]);\n  const [birthdays, setBirthdays] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingBirthdays, setLoadingBirthdays] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMore, setHasMore] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [error, setError] = useState(null);\n  const observer = useRef();\n  const isRequestInProgress = useRef(false);\n  const lastPostElementRef = useRef();\n  const POSTS_PER_PAGE = 10;\n  const fetchPosts = useCallback(async (page = 1, shouldRefresh = false) => {\n    if (isRequestInProgress.current) return;\n    isRequestInProgress.current = true;\n    setError(null);\n    if (page === 1) {\n      setLoading(shouldRefresh ? false : true);\n    } else {\n      setLoadingMore(true);\n    }\n    try {\n      const res = await postService.getPosts(page, POSTS_PER_PAGE);\n      const newPosts = res.data.data || res.data || [];\n      if (page === 1) {\n        // First page or refresh - replace all posts\n        setPosts(newPosts);\n        setCurrentPage(1);\n      } else {\n        // Subsequent pages - append to existing posts\n        setPosts(prevPosts => {\n          const existingIds = new Set(prevPosts.map(post => post._id));\n          const uniqueNewPosts = newPosts.filter(post => !existingIds.has(post._id));\n          return [...prevPosts, ...uniqueNewPosts];\n        });\n      }\n\n      // Update hasMore based on response\n      setHasMore(newPosts.length === POSTS_PER_PAGE);\n    } catch (error) {\n      console.error(\"Error fetching posts:\", error);\n      setError(error.message || \"Failed to load posts\");\n      if (page === 1) {\n        toast.error(\"Could not load posts.\");\n      } else {\n        toast.error(\"Could not load more posts.\");\n      }\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n      isRequestInProgress.current = false;\n    }\n  }, []);\n  const fetchBirthdays = useCallback(async () => {\n    setLoadingBirthdays(true);\n    try {\n      const res = await userService.getTodaysBirthdays();\n      setBirthdays(res.data.data || []);\n    } catch (error) {\n      console.error(\"Error fetching birthdays:\", error);\n      toast.error(\"Could not load birthday information.\");\n    } finally {\n      setLoadingBirthdays(false);\n    }\n  }, []);\n\n  // Intersection Observer for infinite scroll\n  const lastPostElementObserver = useCallback(node => {\n    if (loading || loadingMore || !hasMore) return;\n    if (observer.current) observer.current.disconnect();\n    observer.current = new IntersectionObserver(entries => {\n      if (entries[0].isIntersecting && hasMore && !isRequestInProgress.current) {\n        setCurrentPage(prevPage => {\n          const nextPage = prevPage + 1;\n          fetchPosts(nextPage);\n          return nextPage;\n        });\n      }\n    }, {\n      threshold: 0.1,\n      rootMargin: '200px' // Trigger earlier for smoother UX\n    });\n    if (node) observer.current.observe(node);\n  }, [loading, loadingMore, hasMore, fetchPosts]);\n\n  // Load more posts function for manual button\n  const loadMorePosts = useCallback(() => {\n    if (!loadingMore && hasMore && !isRequestInProgress.current) {\n      setCurrentPage(prevPage => {\n        const nextPage = prevPage + 1;\n        fetchPosts(nextPage);\n        return nextPage;\n      });\n    }\n  }, [loadingMore, hasMore, fetchPosts]);\n  useEffect(() => {\n    if (user) {\n      fetchPosts(1, true);\n      fetchBirthdays();\n    }\n  }, [user, fetchPosts, fetchBirthdays]);\n\n  // Cleanup observer on unmount\n  useEffect(() => {\n    return () => {\n      if (observer.current) observer.current.disconnect();\n    };\n  }, []);\n  const handleDataRefresh = useCallback(() => {\n    setIsRefreshing(true);\n    setCurrentPage(1);\n    setHasMore(true);\n    fetchPosts(1, true).finally(() => setIsRefreshing(false));\n  }, [fetchPosts]);\n  const handlePostCreated = useCallback(() => {\n    // Add a small delay to ensure the backend has processed the new post\n    setTimeout(() => {\n      handleDataRefresh();\n    }, 500);\n  }, [handleDataRefresh]);\n  const dismissBirthday = userId => {\n    setBirthdays(birthdays.filter(b => b._id !== userId));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mx-auto px-3 sm:px-4 lg:px-8 py-4 sm:py-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col lg:flex-row gap-4 sm:gap-6 lg:gap-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full lg:w-1/3 order-1 lg:order-2 space-y-3 sm:space-y-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gradient-to-br from-primary/5 via-secondary/5 to-primary/5 border border-secondary/20 p-3 sm:p-4 rounded-xl shadow-lg lg:sticky lg:top-24\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl sm:text-2xl font-bold text-primary mb-2 sm:mb-3 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xl sm:text-2xl\",\n              children: \"\\uD83C\\uDF82\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 15\n            }, this), \"Happy Birthday!\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 13\n          }, this), loadingBirthdays ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center py-4 sm:py-6\",\n            children: /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 15\n          }, this) : birthdays.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: birthdays.map(bdayUser => /*#__PURE__*/_jsxDEV(BirthdayCard, {\n              user: bdayUser,\n              onDismiss: dismissBirthday\n            }, bdayUser._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center text-gray-500 py-4 sm:py-6 flex flex-col items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-3xl sm:text-4xl mb-2\",\n              children: \"\\uD83C\\uDF88\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm sm:text-base\",\n              children: \"No birthdays today\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full lg:w-2/3 order-2 lg:order-1 space-y-4 sm:space-y-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white border border-primary/20 p-4 sm:p-6 rounded-xl shadow-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl sm:text-2xl font-bold text-primary mb-3 sm:mb-4 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xl sm:text-2xl\",\n              children: \"\\u270D\\uFE0F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this), \"Create a Post\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(PostForm, {\n            onPostCreated: handlePostCreated\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-center\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleDataRefresh,\n            disabled: isRefreshing,\n            className: `inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 border border-transparent text-sm font-medium rounded-full text-white transition-all duration-200 ${isRefreshing ? \"bg-gray-400 cursor-not-allowed\" : \"bg-gradient-to-r from-primary/90 to-primary/70 hover:from-secondary/70 hover:to-secondary/70 hover:shadow-lg transform hover:scale-105 hover:text-gray-700\"}`,\n            children: isRefreshing ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                className: \"w-4 h-4 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"hidden sm:inline\",\n                children: \"Refreshing...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 212,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"sm:hidden\",\n                children: \"Refresh...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                className: \"w-4 h-4 mr-2\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                viewBox: \"0 0 24 24\",\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\",\n                  strokeWidth: 2,\n                  d: \"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"hidden sm:inline\",\n                children: \"Refresh Feed\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 220,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"sm:hidden\",\n                children: \"Refresh\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, this), loading && posts.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-center py-8 sm:py-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center\",\n            children: [/*#__PURE__*/_jsxDEV(Spinner, {\n              className: \"w-6 sm:w-8 h-6 sm:h-8 mx-auto mb-3 sm:mb-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-500 text-sm sm:text-base\",\n              children: \"Loading posts...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 13\n        }, this) : error && posts.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-red-50 border border-red-200 p-6 sm:p-8 rounded-xl shadow-lg text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-4xl sm:text-6xl mb-3 sm:mb-4\",\n            children: \"\\u26A0\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg sm:text-xl font-semibold text-red-800 mb-2\",\n            children: \"Failed to Load Posts\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-red-600 mb-4 text-sm sm:text-base\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => fetchPosts(1, true),\n            className: \"inline-flex items-center px-3 sm:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm sm:text-base\",\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-4 h-4 mr-2\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 17\n            }, this), \"Try Again\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: posts.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-4 sm:space-y-6\",\n            children: [posts.map((post, index) => /*#__PURE__*/_jsxDEV(PostCard, {\n              post: post,\n              refreshFeed: handleDataRefresh\n            }, post._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 23\n            }, this)), loadingMore && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center py-6 sm:py-8\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                  className: \"w-5 sm:w-6 h-5 sm:h-6 mx-auto mb-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-gray-500 text-xs sm:text-sm\",\n                  children: \"Loading more posts...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 21\n            }, this), !loadingMore && hasMore && posts.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center py-4 sm:py-6\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: loadMorePosts,\n                className: \"inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 border border-transparent text-sm font-medium rounded-full text-white bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 hover:shadow-lg transform hover:scale-105 transition-all duration-200\",\n                children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                  className: \"w-4 h-4 mr-2\",\n                  fill: \"none\",\n                  stroke: \"currentColor\",\n                  viewBox: \"0 0 24 24\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    strokeWidth: 2,\n                    d: \"M19 14l-7 7m0 0l-7-7m7 7V3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 278,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 277,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"hidden sm:inline\",\n                  children: \"Load More Posts\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"sm:hidden\",\n                  children: \"Load More\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 21\n            }, this), !hasMore && !loadingMore && posts.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-6 sm:py-8\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"inline-flex items-center justify-center w-10 sm:w-12 h-10 sm:h-12 bg-gray-100 rounded-full mb-3 sm:mb-4\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  className: \"w-5 sm:w-6 h-5 sm:h-6 text-gray-400\",\n                  fill: \"none\",\n                  stroke: \"currentColor\",\n                  viewBox: \"0 0 24 24\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    strokeWidth: 2,\n                    d: \"M5 13l4 4L19 7\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 291,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 290,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-gray-500 text-xs sm:text-sm\",\n                children: \"You've reached the end of the feed\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 p-6 sm:p-8 rounded-xl shadow-lg text-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-4xl sm:text-6xl mb-3 sm:mb-4\",\n              children: \"\\uD83D\\uDCDD\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-lg sm:text-xl font-semibold text-gray-800 mb-2\",\n              children: \"No Posts Yet\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-gray-600 text-sm sm:text-base\",\n              children: \"The community feed is empty. Be the first to share something!\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 17\n          }, this)\n        }, void 0, false)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 155,\n    columnNumber: 5\n  }, this);\n}\n_s(Dashboard, \"hzJauVGjXddaso5fy0petUFJzsY=\", false, function () {\n  return [useAuth];\n});\n_c = Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useAuth","postService","userService","PostCard","PostForm","BirthdayCard","Spinner","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","Dashboard","_s","user","posts","setPosts","birthdays","setBirthdays","loading","setLoading","loadingBirthdays","setLoadingBirthdays","isRefreshing","setIsRefreshing","loadingMore","setLoadingMore","hasMore","setHasMore","currentPage","setCurrentPage","error","setError","observer","isRequestInProgress","lastPostElementRef","POSTS_PER_PAGE","fetchPosts","page","shouldRefresh","current","res","getPosts","newPosts","data","prevPosts","existingIds","Set","map","post","_id","uniqueNewPosts","filter","has","length","console","message","fetchBirthdays","getTodaysBirthdays","lastPostElementObserver","node","disconnect","IntersectionObserver","entries","isIntersecting","prevPage","nextPage","threshold","rootMargin","observe","loadMorePosts","handleDataRefresh","finally","handlePostCreated","setTimeout","dismissBirthday","userId","b","className","children","fileName","_jsxFileName","lineNumber","columnNumber","bdayUser","onDismiss","onPostCreated","onClick","disabled","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","index","refreshFeed","_c","$RefreshReg$"],"sources":["/Users/sumitdhaker/Desktop/JNV MAA/frontend/src/pages/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport useAuth from \"../hooks/useAuth\";\nimport postService from \"../services/postService\";\nimport userService from \"../services/userService\";\nimport PostCard from \"../components/posts/PostCard\";\nimport PostForm from \"../components/posts/PostForm\";\nimport BirthdayCard from \"../components/home/BirthdayCard\";\nimport Spinner from \"../components/common/Spinner\";\nimport toast from \"react-hot-toast\";\n\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const [posts, setPosts] = useState([]);\n  const [birthdays, setBirthdays] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [loadingBirthdays, setLoadingBirthdays] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [hasMore, setHasMore] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [error, setError] = useState(null);\n\n  const observer = useRef();\n  const isRequestInProgress = useRef(false);\n  const lastPostElementRef = useRef();\n\n  const POSTS_PER_PAGE = 10;\n\n  const fetchPosts = useCallback(async (page = 1, shouldRefresh = false) => {\n    if (isRequestInProgress.current) return;\n    \n    isRequestInProgress.current = true;\n    setError(null);\n    \n    if (page === 1) {\n      setLoading(shouldRefresh ? false : true);\n    } else {\n      setLoadingMore(true);\n    }\n    \n    try {\n      const res = await postService.getPosts(page, POSTS_PER_PAGE);\n      const newPosts = res.data.data || res.data || [];\n      \n      if (page === 1) {\n        // First page or refresh - replace all posts\n        setPosts(newPosts);\n        setCurrentPage(1);\n      } else {\n        // Subsequent pages - append to existing posts\n        setPosts(prevPosts => {\n          const existingIds = new Set(prevPosts.map(post => post._id));\n          const uniqueNewPosts = newPosts.filter(post => !existingIds.has(post._id));\n          return [...prevPosts, ...uniqueNewPosts];\n        });\n      }\n      \n      // Update hasMore based on response\n      setHasMore(newPosts.length === POSTS_PER_PAGE);\n      \n    } catch (error) {\n      console.error(\"Error fetching posts:\", error);\n      setError(error.message || \"Failed to load posts\");\n      \n      if (page === 1) {\n        toast.error(\"Could not load posts.\");\n      } else {\n        toast.error(\"Could not load more posts.\");\n      }\n    } finally {\n      setLoading(false);\n      setLoadingMore(false);\n      isRequestInProgress.current = false;\n    }\n  }, []);\n\n  const fetchBirthdays = useCallback(async () => {\n    setLoadingBirthdays(true);\n    try {\n      const res = await userService.getTodaysBirthdays();\n      setBirthdays(res.data.data || []);\n    } catch (error) {\n      console.error(\"Error fetching birthdays:\", error);\n      toast.error(\"Could not load birthday information.\");\n    } finally {\n      setLoadingBirthdays(false);\n    }\n  }, []);\n\n  // Intersection Observer for infinite scroll\n  const lastPostElementObserver = useCallback(node => {\n    if (loading || loadingMore || !hasMore) return;\n    if (observer.current) observer.current.disconnect();\n    \n    observer.current = new IntersectionObserver(entries => {\n      if (entries[0].isIntersecting && hasMore && !isRequestInProgress.current) {\n        setCurrentPage(prevPage => {\n          const nextPage = prevPage + 1;\n          fetchPosts(nextPage);\n          return nextPage;\n        });\n      }\n    }, {\n      threshold: 0.1,\n      rootMargin: '200px' // Trigger earlier for smoother UX\n    });\n    \n    if (node) observer.current.observe(node);\n  }, [loading, loadingMore, hasMore, fetchPosts]);\n\n  // Load more posts function for manual button\n  const loadMorePosts = useCallback(() => {\n    if (!loadingMore && hasMore && !isRequestInProgress.current) {\n      setCurrentPage(prevPage => {\n        const nextPage = prevPage + 1;\n        fetchPosts(nextPage);\n        return nextPage;\n      });\n    }\n  }, [loadingMore, hasMore, fetchPosts]);\n\n  useEffect(() => {\n    if (user) {\n      fetchPosts(1, true);\n      fetchBirthdays();\n    }\n  }, [user, fetchPosts, fetchBirthdays]);\n\n  // Cleanup observer on unmount\n  useEffect(() => {\n    return () => {\n      if (observer.current) observer.current.disconnect();\n    };\n  }, []);\n\n  const handleDataRefresh = useCallback(() => {\n    setIsRefreshing(true);\n    setCurrentPage(1);\n    setHasMore(true);\n    fetchPosts(1, true).finally(() => setIsRefreshing(false));\n  }, [fetchPosts]);\n\n  const handlePostCreated = useCallback(() => {\n    // Add a small delay to ensure the backend has processed the new post\n    setTimeout(() => {\n      handleDataRefresh();\n    }, 500);\n  }, [handleDataRefresh]);\n\n  const dismissBirthday = (userId) => {\n    setBirthdays(birthdays.filter((b) => b._id !== userId));\n  };\n\n  return (\n    <div className=\"container mx-auto px-3 sm:px-4 lg:px-8 py-4 sm:py-6\">\n      <div className=\"flex flex-col lg:flex-row gap-4 sm:gap-6 lg:gap-8\">\n        {/* Birthday Section - Mobile: Full width, Desktop: Sidebar */}\n        <div className=\"w-full lg:w-1/3 order-1 lg:order-2 space-y-3 sm:space-y-4\">\n          <div className=\"bg-gradient-to-br from-primary/5 via-secondary/5 to-primary/5 border border-secondary/20 p-3 sm:p-4 rounded-xl shadow-lg lg:sticky lg:top-24\">\n            <h2 className=\"text-xl sm:text-2xl font-bold text-primary mb-2 sm:mb-3 flex items-center gap-2\">\n              <span className=\"text-xl sm:text-2xl\">üéÇ</span>\n              Happy Birthday!\n            </h2>\n            {loadingBirthdays ? (\n              <div className=\"flex justify-center py-4 sm:py-6\">\n                <Spinner />\n              </div>\n            ) : birthdays.length > 0 ? (\n              <div className=\"space-y-2\">\n                {birthdays.map((bdayUser) => (\n                  <BirthdayCard\n                    key={bdayUser._id}\n                    user={bdayUser}\n                    onDismiss={dismissBirthday}\n                  />\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center text-gray-500 py-4 sm:py-6 flex flex-col items-center\">\n                <span className=\"text-3xl sm:text-4xl mb-2\">üéà</span>\n                <p className=\"text-sm sm:text-base\">No birthdays today</p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Posts Section - Mobile: Full width, Desktop: Main content */}\n        <div className=\"w-full lg:w-2/3 order-2 lg:order-1 space-y-4 sm:space-y-6\">\n          {/* Post Creation Form */}\n          <div className=\"bg-white border border-primary/20 p-4 sm:p-6 rounded-xl shadow-lg\">\n            <h2 className=\"text-xl sm:text-2xl font-bold text-primary mb-3 sm:mb-4 flex items-center gap-2\">\n              <span className=\"text-xl sm:text-2xl\">‚úçÔ∏è</span>\n              Create a Post\n            </h2>\n            <PostForm onPostCreated={handlePostCreated} />\n          </div>\n\n          {/* Refresh Button */}\n          <div className=\"flex justify-center\">\n            <button\n              onClick={handleDataRefresh}\n              disabled={isRefreshing}\n              className={`inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 border border-transparent text-sm font-medium rounded-full text-white transition-all duration-200 ${\n                isRefreshing\n                  ? \"bg-gray-400 cursor-not-allowed\"\n                  : \"bg-gradient-to-r from-primary/90 to-primary/70 hover:from-secondary/70 hover:to-secondary/70 hover:shadow-lg transform hover:scale-105 hover:text-gray-700\"\n              }`}\n            >\n              {isRefreshing ? (\n                <>\n                  <Spinner className=\"w-4 h-4 mr-2\" />\n                  <span className=\"hidden sm:inline\">Refreshing...</span>\n                  <span className=\"sm:hidden\">Refresh...</span>\n                </>\n              ) : (\n                <>\n                  <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                  </svg>\n                  <span className=\"hidden sm:inline\">Refresh Feed</span>\n                  <span className=\"sm:hidden\">Refresh</span>\n                </>\n              )}\n            </button>\n          </div>\n\n          {/* Posts Feed */}\n          {loading && posts.length === 0 ? (\n            <div className=\"flex justify-center py-8 sm:py-12\">\n              <div className=\"text-center\">\n                <Spinner className=\"w-6 sm:w-8 h-6 sm:h-8 mx-auto mb-3 sm:mb-4\" />\n                <p className=\"text-gray-500 text-sm sm:text-base\">Loading posts...</p>\n              </div>\n            </div>\n          ) : error && posts.length === 0 ? (\n            <div className=\"bg-red-50 border border-red-200 p-6 sm:p-8 rounded-xl shadow-lg text-center\">\n              <div className=\"text-4xl sm:text-6xl mb-3 sm:mb-4\">‚ö†Ô∏è</div>\n              <h3 className=\"text-lg sm:text-xl font-semibold text-red-800 mb-2\">\n                Failed to Load Posts\n              </h3>\n              <p className=\"text-red-600 mb-4 text-sm sm:text-base\">{error}</p>\n              <button\n                onClick={() => fetchPosts(1, true)}\n                className=\"inline-flex items-center px-3 sm:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm sm:text-base\"\n              >\n                <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                </svg>\n                Try Again\n              </button>\n            </div>\n          ) : (\n            <>\n              {posts.length > 0 ? (\n                <div className=\"space-y-4 sm:space-y-6\">\n                  {posts.map((post, index) => (\n                      <PostCard key={post._id} post={post} refreshFeed={handleDataRefresh} />  \n                  ))}\n                  \n                  {/* Loading more indicator */}\n                  {loadingMore && (\n                    <div className=\"flex justify-center py-6 sm:py-8\">\n                      <div className=\"text-center\">\n                        <Spinner className=\"w-5 sm:w-6 h-5 sm:h-6 mx-auto mb-2\" />\n                        <p className=\"text-gray-500 text-xs sm:text-sm\">Loading more posts...</p>\n                      </div>\n                    </div>\n                  )}\n                  \n                  {/* Load More Button - only show if not loading and has more posts */}\n                  {!loadingMore && hasMore && posts.length > 0 && (\n                    <div className=\"flex justify-center py-4 sm:py-6\">\n                      <button\n                        onClick={loadMorePosts}\n                        className=\"inline-flex items-center px-4 sm:px-6 py-2 sm:py-3 border border-transparent text-sm font-medium rounded-full text-white bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 hover:shadow-lg transform hover:scale-105 transition-all duration-200\"\n                      >\n                        <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 14l-7 7m0 0l-7-7m7 7V3\" />\n                        </svg>\n                        <span className=\"hidden sm:inline\">Load More Posts</span>\n                        <span className=\"sm:hidden\">Load More</span>\n                      </button>\n                    </div>\n                  )}\n                  \n                  {/* End of feed indicator */}\n                  {!hasMore && !loadingMore && posts.length > 0 && (\n                    <div className=\"text-center py-6 sm:py-8\">\n                      <div className=\"inline-flex items-center justify-center w-10 sm:w-12 h-10 sm:h-12 bg-gray-100 rounded-full mb-3 sm:mb-4\">\n                        <svg className=\"w-5 sm:w-6 h-5 sm:h-6 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                        </svg>\n                      </div>\n                      <p className=\"text-gray-500 text-xs sm:text-sm\">You've reached the end of the feed</p>\n                    </div>\n                  )}\n                </div>\n              ) : (\n                <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 p-6 sm:p-8 rounded-xl shadow-lg text-center\">\n                  <div className=\"text-4xl sm:text-6xl mb-3 sm:mb-4\">üìù</div>\n                  <h3 className=\"text-lg sm:text-xl font-semibold text-gray-800 mb-2\">\n                    No Posts Yet\n                  </h3>\n                  <p className=\"text-gray-600 text-sm sm:text-base\">\n                    The community feed is empty. Be the first to share something!\n                  </p>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}